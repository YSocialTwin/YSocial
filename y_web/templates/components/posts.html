{% for index, item in enumerate(items) %}
<div id="feed-post-{{ item['post_id'] }}" class="card is-post" style="margin-bottom: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08); transition: box-shadow 0.3s ease;">

    <div class="content-wrap" id="post-{{ item['post_id'] }}" style="padding: 1rem;">
        <!-- Post header -->
        <div class="card-heading">
            <!-- User meta -->
            <div class="user-block">
                <div class="image">
                    <img
                            src="https://via.placeholder.com/300x300"
                            {% if item['profile_pic'] == "" %}
                                data-demo-src="{{ url_for('static', filename='assets/img/users/'+ str(item['author_id']) +'.png') }}"
                            {% else %}
                                data-demo-src="{{ item['profile_pic'] }}"
                            {% endif %}
                            data-user-popover="1"
                            alt=""
                    />

                </div>
                <div class="user-info">
                    <a href="/profile/{{ item['author_id'] }}/recent/1">{{ item["author"] }}</a>
                    <span class="time">Day {{ item["day"] }} - {{item["hour"]}}:00</span>
                </div>
            </div>
            <!-- Right side dropdown -->
            <!-- /partials/pages/feed/dropdowns/feed-post-dropdown.html -->
            <div class="dropdown is-spaced is-right is-neutral dropdown-trigger">
                <div>
                    <div class="button">
                        <i data-feather="more-vertical"></i>
                    </div>
                </div>
                <div class="dropdown-menu" role="menu">
                    <div class="dropdown-content">
                        <a href="/thread/{{ item['post_id'] }}" class="dropdown-item">
                            <div class="media">
                                <i data-feather="bookmark"></i>
                                <div class="media-content">
                                    <h3>Discussion</h3>
                                    <small>See full discussion thread</small>
                                </div>
                            </div>
                        </a>
                        {% if item['author_id'] == user_id %}
                        <a class="dropdown-item" id="delete_post" val="{{ item['post_id'] }}">
                            <div class="media">
                                <i data-feather="bell"></i>
                                <div class="media-content">
                                    <h3 val="{{ item['post_id'] }}">Delete</h3>
                                    <small></small>
                                </div>
                            </div>
                        </a>
                        <!-- <hr class="dropdown-divider"/> -->
                        {% endif %}
                        <!-- <a href="#" class="dropdown-item">
                            <div class="media">
                                <i data-feather="flag"></i>
                                <div class="media-content">
                                    <h3>Flag</h3>
                                    <small>In case of inappropriate content.</small>
                                </div>

                            </div>
                        </a> -->
                    </div>
                </div>
            </div>
        </div>
        <!-- /Post header -->

        <!-- Post body -->
        <div class="card-body">
            <!-- Post body text -->
            <div class="post-text">
                {% if item["shared_from"] != -1 %}
                <div style="text-align: right; border-bottom: 2px solid #f4f4f4; margin-bottom: 5px;">
                    <p><small>Shared from: <a href="/thread/{{ item['shared_from'][0] }}">{{ item['shared_from'][1] }}</a></small></p>
                </div>
                {% endif %}
                <p>
                    {{ item["post"]|safe }}
                    {% if item['image'] != "" and item["article"] == 0  %}
                    <div class="post-image" style="text-align: center; width: 100%; margin-top: 1rem;">
                        <img src="{{ item['image'].url }}" style="max-width: 100%; width: auto; height: auto; margin: auto; display: block; border-radius: 8px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);" alt="{{ item['image'].description }}"/>
                     </div>
                    {% endif %}
                    {% if item["article"] != 0 %}
                    <div class="media-body-news" style="padding: 1rem; margin: 1rem 0; background-color: #f9f9f9; border-radius: 12px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);">
                    <object data="{{ item['article']['url'] }}" width="100%" height="300" type="text/html">
                        <h7><a href="{{ item['article']['url'] }}" style="font-weight: 600; color: #3273dc; text-decoration: none; transition: color 0.2s ease;">{{ item["article"]["title"] }}</a></h7>
                        {% if item['image'] != "" %}
                        <div class="post-image" style="text-align: center; width: 100%; margin-top: 1rem;">
                            <img src="{{ item['image'].url }}" style="max-width: 100%; width: auto; height: auto; margin: auto; display: block; border-radius: 8px;" alt="{{ item['image'].description }}"/>
                        </div>
                        {% endif %}
                        <p class="card-text text-justify" style="font-size: 0.9rem; margin-top: 0.75rem; line-height: 1.5;">{{ item["article"]["summary"] }}</p>
                    </object>
                    </div>

                {% endif %}
                </p>
            </div>
            <!-- Featured image -->

        </div>
        <!-- /Post body -->

        <!-- Post footer -->
        <div class="card-footer" style="display: flex; flex-wrap: wrap; gap: 1rem; align-items: center; padding: 1rem;">
            <!-- Followers avatars -->

            <!-- Followers text -->
            <div class="likers-text" style="display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center;">
                {% if len(item['emotions']) > 0 %}
                <p>Emotions</p>
                {% for em in item['emotions'] %}
                <a class="mdi {{ em[1] }}" title="{{ em[0] }}" style="font-size: .8rem" href="/emotion/{{ em[2] }}/1"></a>
                {% endfor %}
                {% endif %}
            </div>
            <div class="likers-text" style="display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center;">
                {% if len(item['topics']) > 0 %}
                <p>Topics</p>
                {% for tp in item['topics'] %}
                    {% if tp[2] == 'positive' %}
                        <a  href="/interest/{{ tp[0] }}/1" style="color: #0bc350; font-size: .8rem; border: #0bc350 1px solid; padding: 2px; border-radius: 10%"> {{ tp[1] }}</a>
                    {% elif tp[2] == 'negative' %}
                        <a  href="/interest/{{ tp[0] }}/1" style="color: #e60000; font-size: .8rem; border: #e60000 1px solid; padding: 2px; border-radius: 10%"> {{ tp[1] }}</a>
                    {% else %}
                        <a  href="/interest/{{ tp[0] }}/1" style="color: #00b2ff; font-size: .8rem; border: #00b2ff 1px solid; padding: 2px; border-radius: 10%"> {{ tp[1] }}</a>
                    {% endif %}
                {% endfor %}
                {% endif %}
            </div>
            <!-- Post statistics -->
            <div class="social-count" style="display: flex; flex-wrap: wrap; gap: 0.75rem; margin-left: auto; align-items: center;">

                <div class="likes-count" id="share-count-{{ item['post_id'] }}" style="flex-shrink: 0;">
                    <div class="like-wrapper" id="share-{{ item['post_id'] }}">
                        <a class="share-button" id="s{{ item['post_id']}}" style="display: flex; align-items: center; gap: 0.25rem; padding: 0.5rem 0.75rem; border-radius: 8px; transition: all 0.2s ease;">
                        <i data-feather="repeat"></i>
                        <span id="span-{{item['post_id']}}">{{ item['is_shared'] }}</span> </a>
                    </div>
                </div>

                <div class="likes-count" id="likes-count-{{ item['post_id'] }}" style="flex-shrink: 0;">
                    <div class="like-wrapper" id="like-{{ item['post_id'] }}">
                        <a class="like-button" id="l{{ item['post_id']}}" {% if not bool(item["is_liked"]) %} style="background: #6aa3e7; display: flex; align-items: center; gap: 0.25rem; padding: 0.5rem 0.75rem; border-radius: 8px; transition: all 0.2s ease;"{% else %}style="display: flex; align-items: center; gap: 0.25rem; padding: 0.5rem 0.75rem; border-radius: 8px; transition: all 0.2s ease;"{% endif %} >
                        <i data-feather="thumbs-up" {% if not bool(item['is_liked']) %}style="stroke: #ffffff;"{% endif %}></i>
                        <span id="span-{{item['post_id']}}" {% if not bool(item['is_liked']) %}style="color: #ffffff;"{% endif %}>{{ item['likes'] }}</span> </a>
                    </div>
                </div>

                <div class="likes-count" id="dislikes-count-{{ item['post_id'] }}" style="flex-shrink: 0;">
                    <div class="dislike-wrapper" id="dislike-{{ item['post_id'] }}">
                        <a class="dislike-button" id="d{{ item['post_id'] }}" {% if not bool(item["is_disliked"]) %} style="background: #6aa3e7; display: flex; align-items: center; gap: 0.25rem; padding: 0.5rem 0.75rem; border-radius: 8px; transition: all 0.2s ease;"{% else %}style="display: flex; align-items: center; gap: 0.25rem; padding: 0.5rem 0.75rem; border-radius: 8px; transition: all 0.2s ease;"{% endif %} >
                        <i data-feather="thumbs-down" {% if not bool(item["is_disliked"]) %} style="stroke: #ffffff;" {% endif %}></i>
                        <span id="span-{{ item['post_id'] }}" {% if not bool(item["is_disliked"]) %}style="color: #ffffff;" {% endif %}>{{ item["dislikes"] }}</span>
                        </a>
                    </div>
                </div>
                <!--<div class="shares-count">
                  <i data-feather="link-2"></i>
                  <span>9</span>
                </div> -->

                <!--<div class="comments-count">-->

                <div class="fab-wrapper is-comment" style="flex-shrink: 0;">
                    <a href="javascript:void(0);" class="small-fab" style="display: flex; align-items: center; gap: 0.25rem; padding: 0.5rem 0.75rem; border-radius: 8px; transition: all 0.2s ease;"><i data-feather="message-circle"></i>
                        <span>{{  item["t_comments"]  }}</span></a>
                </div>

            </div>
        </div>
        <!-- /Post footer -->
    </div>
    <!-- /Main wrap -->

    <!-- Post #1 Comments -->

    <div class="comments-wrap is-hidden">
        <!-- Header -->
        <div class="comments-heading">
            <h4>Comments <small>({{ item["t_comments"] }})</small></h4>
            <div class="close-comments">
                <i data-feather="x"></i>
            </div>
        </div>
        <!-- /Header -->
        <!-- Post  -->
        <!-- Comments body -->
        <div class="comments-body has-slimscroll">
            <!-- Comment -->
            <div class="original-post">
                <div class="media-content">
                    <a href="/profile/{{ item['author_id'] }}/recent/1">{{ item["author"] }}</a><br/>
                    <span class="time">Day {{ item["day"] }} - {{item["hour"]}}:00</span>
                    <div class="post-text">
                        <p> {{ item["post"]|safe }}</p>
                    </div>
                    <div class="card-footer" style="display: flex; flex-wrap: wrap; gap: 0.75rem; align-items: center; padding: 0.75rem 0;">
                        <div class="likers-text" style="display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center;">
                            {% if len(item['emotions']) > 0 %}
                            <p>Emotions</p>
                            {% for em in item['emotions'] %}
                            <a class="mdi {{ em[1] }}" title="{{ em[0] }}" href="/emotion/{{ em[2] }}/1"></a>
                            {% endfor %}
                            {% endif %}
                        </div>
                        <div class="likers-text" style="display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center;">
                            {% if len(item['topics']) > 0 %}
                            <p>Topics</p>
                            {% for tp in item['topics'] %}
                                {% if tp[2] == 'positive' %}
                                    <a  href="/interest/{{ tp[0] }}/1" style="color: #0bc350; font-size: .8rem; border: #0bc350 1px solid; padding: 2px; border-radius: 10%"> {{ tp[1] }}</a>
                                {% elif tp[2] == 'negative' %}
                                    <a  href="/interest/{{ tp[0] }}/1" style="color: #e60000; font-size: .8rem; border: #e60000 1px solid; padding: 2px; border-radius: 10%"> {{ tp[1] }}</a>
                                {% else %}
                                    <a  href="/interest/{{ tp[0] }}/1" style="color: #00b2ff; font-size: .8rem; border: #00b2ff 1px solid; padding: 2px; border-radius: 10%"> {{ tp[1] }}</a>
                                {% endif %}
                            {% endfor %}
                            {% endif %}
                        </div>
                    </div>

                    <div class="reply" style="text-align: right">
                        <a id='{{ item["post_id"] }}' onClick="editLink(this.id)">Reply</a>
                    </div>
                    <p id="message-{{ item['post_id']}}"></p>
                    <form class="comment_form" id="comment_form-{{item['post_id']}}" style="margin-top: 1rem;">
                    <textarea rows="3" class="reply_comment" id="comment-{{ item['post_id'] }}" style="width: 100%; padding: 0.75rem; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 0.95rem; resize: vertical; margin-bottom: 0.75rem;">@{{ item["author"]}} </textarea>
                    <button
                            id="add_comment"
                            type="button"
                            class="button is-solid accent-button is-fullwidth"
                            val="{{ item['post_id'] }}"
                            style="border-radius: 8px; padding: 0.75rem 1.5rem; transition: all 0.2s ease;"
                    >
                    Comment
                    </button>
                    </form>

                </div>
                <hr>
            </div>
            {% for id1, cm in enumerate(item["comments"]) %}
            <div class="media is-comment">
                <!-- User image -->
                <div class="media-left">
                    <div class="image">
                        <img
                                src="https://via.placeholder.com/300x300"
                                {% if cm['profile_pic'] == "" %}
                                    data-demo-src="{{ url_for('static', filename='assets/img/users/'+ str(cm['author_id']) +'.png') }}"
                                {% else %}
                                    data-demo-src="{{ cm['profile_pic'] }}"
                                {% endif %}
                                   data-user-popover="1"
                                alt=""
                        />
                    </div>
                </div>
                <!-- Content -->
                <div class="media-content">
                    <a href="/profile/{{ cm['author_id'] }}/recent/1">{{ cm["author"] }}</a>
                    <span class="time">Day {{ cm["day"] }} - {{cm["hour"]}}:00</span>
                    <p>
                        {{ cm["post"]|safe }}
                    </p>
                    <!-- Actions -->
                    <div class="card-footer" style="display: flex; flex-wrap: wrap; gap: 0.75rem; align-items: center; padding: 0.75rem 0;">
                        <div class="likers-text" style="display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center;">
                            {% if len(cm['emotions']) > 0 %}
                            <p>Emotions</p>
                            {% for em in cm['emotions'] %}
                            <a class="mdi {{ em[1] }}" title="{{ em[0] }}" href="/emotion/{{ em[2] }}/1"></a>
                            {% endfor %}
                            {% endif %}
                        </div>
                        <div class="likers-text" style="display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center;">
                            {% if len(cm['topics']) > 0 %}
                            <p>Topics</p>
                            {% for tp in cm['topics'] %}
                                {% if tp[2] == 'positive' %}
                                    <a  href="/interest/{{ tp[0] }}/1" style="color: #0bc350; font-size: .8rem; border: #0bc350 1px solid; padding: 2px; border-radius: 10%"> {{ tp[1] }}</a>
                                {% elif tp[2] == 'negative' %}
                                    <a  href="/interest/{{ tp[0] }}/1" style="color: #e60000; font-size: .8rem; border: #e60000 1px solid; padding: 2px; border-radius: 10%"> {{ tp[1] }}</a>
                                {% else %}
                                    <a  href="/interest/{{ tp[0] }}/1" style="color: #00b2ff; font-size: .8rem; border: #00b2ff 1px solid; padding: 2px; border-radius: 10%"> {{ tp[1] }}</a>
                                {% endif %}
                            {% endfor %}
                            {% endif %}
                        </div>
                    </div>
                    <div class="controls" style="display: flex; flex-wrap: wrap; gap: 0.75rem; align-items: center;">
                        <div class="like-count" id="like-count-{{cm['post_id']}}" style="display: flex; align-items: center; gap: 0.25rem;">
                            <i data-feather="thumbs-up" {% if not bool(cm["is_liked"]) %}style="stroke: #69a2e6;"{% endif %}></i>
                            <span {% if not bool(cm["is_liked"]) %}style="color: #69a2e6;"{% endif %}>{{ cm["likes"] }}</span>
                        </div>

                        <div class="dislike-count" id="dislike-count-{{ cm['post_id'] }}" style="display: flex; align-items: center; gap: 0.25rem;">
                            <i data-feather="thumbs-down" {% if not bool(cm["is_disliked"]) %}style="stroke: #69a2e6;"{% endif %} ></i>
                            <span {% if not bool(cm["is_disliked"]) %} style="color: #69a2e6;"{% endif %}>{{ cm["dislikes"] }}</span>
                        </div>
                        <div class="share-count" id="share-count-{{ cm['post_id'] }}" style="display: flex; align-items: center; gap: 0.25rem;">
                            <i data-feather="repeat"></i>
                            <span>{{ cm["is_shared"] }}</span>
                        </div>

                <!-- <div class="reply" style="text-align: right">
                   <a href="#">Reply</a>
                 </div> -->
                <!-- <div class="edit">
                  <a href="#">Edit</a>
                </div> -->
            </div>
            <div class="reply" style="text-align: right">
                <a id='{{ cm["post_id"] }}' onClick="editLink(this.id)">Reply</a>
            </div>
            <p id="message-{{ cm['post_id'] }}"></p>
            <form class="comment_form" id="comment_form-{{cm['post_id']}}" style="margin-top: 1rem;">
            <textarea rows="3" class="reply_comment" id="comment-{{ cm['post_id'] }}" style="width: 100%; padding: 0.75rem; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 0.95rem; resize: vertical; margin-bottom: 0.75rem;">@{{ cm["author"] }} </textarea>
            <button
                    id="add_comment"
                    type="button"
                    class="button is-solid accent-button is-fullwidth"
                    val="{{cm['post_id']}}"
                    style="border-radius: 8px; padding: 0.75rem 1.5rem; transition: all 0.2s ease;"
            >
            Comment
            </button>
            </form>
        </div>
        <!-- Right side dropdown -->
        <div class="media-right">
            <!-- /partials/pages/feed/dropdowns/comment-dropdown.html -->
            <div class="dropdown is-spaced is-right is-neutral dropdown-trigger">
                <div>
                    <div class="button">
                        <i data-feather="more-vertical"></i>
                    </div>
                </div>
                <div class="dropdown-menu" role="menu">
                    <div class="dropdown-content">
                        <!-- <a class="dropdown-item">
                           <div class="media">
                             <i data-feather="x"></i>
                             <div class="media-content">
                               <h3>Hide</h3>
                               <small>Hide this comment.</small>
                             </div>
                           </div>
                         </a>
                         <div class="dropdown-divider"></div> -->
                        <!-- <a href="#" class="dropdown-item">
                            <div class="media">
                                <i data-feather="flag"></i>
                                <div class="media-content">
                                    <h3>Report</h3>
                                    <small>Report this comment.</small>
                                </div>
                            </div>
                        </a> -->
                    </div>
                </div>
            </div>
        </div>

    </div>

    {% endfor %}


    <!-- /Comment -->

</div>

</div>

<!-- /Post #1 Comments -->
</div>
{% endfor %}